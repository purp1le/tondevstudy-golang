package app

import (
	"encoding/base64"
	"encoding/json"
	"os"
	"strconv"
	"strings"

	"github.com/joho/godotenv"
	"github.com/sirupsen/logrus"
	"github.com/xssnick/tonutils-go/liteclient"
	"github.com/xssnick/tonutils-go/tvm/cell"
)

type appConfig struct {
	Postgres struct {
		HOST, PORT, USER, PASSWORD,
		NAME, SSLMODE, TIMEZONE string
	}

	Logger struct {
		LOGLVL string
	}

	MAINNET_CONFIG *liteclient.GlobalConfig
	START_BLOCK    uint64

	Wallet struct {
		SEED []string
	}
}

var CFG *appConfig = &appConfig{}
var DedustPoolCodeHash string
var StonfiPoolCodeHash string
var dedustCode = "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"
var stonfiCode = "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"

func InitDedustCode() error {
	codeBytes, err := base64.StdEncoding.DecodeString(dedustCode)
	if err != nil {
		return err
	}

	codeCell, err := cell.FromBOC(codeBytes)
	if err != nil {
		logrus.Error(err)
		return err
	}

	DedustPoolCodeHash = base64.StdEncoding.EncodeToString(codeCell.Hash())
	return nil
}

func InitStonfiCode() error {
	codeBytes, err := base64.StdEncoding.DecodeString(stonfiCode)
	if err != nil {
		return err
	}

	codeCell, err := cell.FromBOC(codeBytes)
	if err != nil {
		logrus.Error(err)
		return err
	}

	StonfiPoolCodeHash = base64.StdEncoding.EncodeToString(codeCell.Hash())
	return nil
}

func InitConfig() (err error) {

	if err := InitDedustCode(); err != nil {
		logrus.Error(err)
		return err
	}

	if err := InitStonfiCode(); err != nil {
		logrus.Error(err)
		return err
	}

	godotenv.Load(".env")

	CFG.Postgres.HOST = os.Getenv("POSTGRES_HOST")
	CFG.Postgres.PORT = os.Getenv("POSTGRES_PORT")
	CFG.Postgres.USER = os.Getenv("POSTGRES_USER")
	CFG.Postgres.PASSWORD = os.Getenv("POSTGRES_PASSWORD")
	CFG.Postgres.NAME = os.Getenv("POSTGRES_DB")
	CFG.Postgres.SSLMODE = os.Getenv("POSTGRES_SSLMODE")
	CFG.Postgres.TIMEZONE = os.Getenv("POSTGRES_TIMEZONE")

	CFG.Logger.LOGLVL = os.Getenv("LOGL")

	CFG.START_BLOCK, err = strconv.ParseUint(os.Getenv("START_BLOCK"), 10, 64)
	if err != nil {
		return err
	}

	jsonConfig, err := os.Open("mainnet-config.json")
	if err == nil {

		if err := json.NewDecoder(jsonConfig).Decode(&CFG.MAINNET_CONFIG); err != nil {
			return err
		}
	} else {
		logrus.Error(err)
		CFG.MAINNET_CONFIG = nil
	}
	defer jsonConfig.Close()

	CFG.Wallet.SEED = strings.Split(os.Getenv("SEED"), ";")

	return nil
}
